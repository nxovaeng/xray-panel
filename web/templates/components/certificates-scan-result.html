{{define "components/certificates-scan-result.html"}}
<div class="scan-results">
    {{if .certificates}}
    <div style="margin-bottom: 1rem; padding: 1rem; background: rgba(34, 197, 94, 0.1); border-radius: 8px; border: 1px solid rgba(34, 197, 94, 0.3);">
        <div style="display: flex; align-items: center; gap: 0.5rem; color: rgb(34, 197, 94);">
            <i data-lucide="check-circle" style="width: 20px; height: 20px;"></i>
            <strong>扫描完成</strong>
        </div>
        <div style="margin-top: 0.5rem; color: var(--text-secondary);">
            在 <code>{{.cert_dir}}</code> 目录下找到 {{.count}} 个证书
        </div>
    </div>

    <table class="data-table">
        <thead>
            <tr>
                <th>主域名</th>
                <th>证书包含的域名</th>
                <th>过期时间</th>
                <th>状态</th>
                <th>颁发者</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {{range .certificates}}
            <tr>
                <td>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        {{if .is_wildcard}}
                        <i data-lucide="asterisk" style="width: 16px; color: rgb(168, 85, 247);" title="通配符证书"></i>
                        {{else}}
                        <i data-lucide="globe" style="width: 16px; color: var(--text-secondary);"></i>
                        {{end}}
                        <strong>{{.domain}}</strong>
                    </div>
                </td>
                <td>
                    <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                        {{range .domains}}
                        <div style="display: flex; align-items: center; gap: 0.25rem;">
                            {{if hasPrefix . "*."}}
                            <span class="badge" style="background: rgba(168, 85, 247, 0.2); color: rgb(192, 132, 252); font-size: 0.75rem;">
                                <i data-lucide="asterisk" style="width: 10px; height: 10px;"></i>
                                {{.}}
                            </span>
                            {{else}}
                            <code style="font-size: 0.875rem;">{{.}}</code>
                            {{end}}
                        </div>
                        {{end}}
                    </div>
                </td>
                <td>
                    <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                        <div style="font-size: 0.875rem;">{{formatTime .expiry_date}}</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">
                            {{if gt .days_to_expiry 0}}
                            还有 {{.days_to_expiry}} 天
                            {{else if eq .days_to_expiry 0}}
                            今天过期
                            {{else}}
                            已过期 {{abs .days_to_expiry}} 天
                            {{end}}
                        </div>
                    </div>
                </td>
                <td>
                    {{if eq .status "有效"}}
                    <span class="badge" style="background: rgba(34, 197, 94, 0.2); color: rgb(34, 197, 94);">
                        <i data-lucide="check-circle" style="width: 12px; height: 12px;"></i>
                        {{.status}}
                    </span>
                    {{else if eq .status "即将过期"}}
                    <span class="badge" style="background: rgba(251, 191, 36, 0.2); color: rgb(251, 191, 36);">
                        <i data-lucide="alert-triangle" style="width: 12px; height: 12px;"></i>
                        {{.status}}
                    </span>
                    {{else if eq .status "已过期"}}
                    <span class="badge" style="background: rgba(239, 68, 68, 0.2); color: rgb(239, 68, 68);">
                        <i data-lucide="x-circle" style="width: 12px; height: 12px;"></i>
                        {{.status}}
                    </span>
                    {{else}}
                    <span class="badge" style="background: rgba(107, 114, 128, 0.2); color: rgb(156, 163, 175);">
                        <i data-lucide="help-circle" style="width: 12px; height: 12px;"></i>
                        {{.status}}
                    </span>
                    {{end}}
                </td>
                <td>
                    <div style="font-size: 0.875rem; color: var(--text-secondary);">{{.issuer}}</div>
                </td>
                <td>
                    <button 
                        hx-post="/api/domains/import-cert" 
                        hx-vals='{"cert_path": "{{.cert_path}}", "key_path": "{{.key_path}}", "domain": "{{.domain}}"}'
                        hx-target="#domains-table" 
                        hx-swap="innerHTML"
                        class="btn btn-sm btn-primary"
                        title="导入此证书">
                        <i data-lucide="download" style="width: 14px; height: 14px;"></i>
                        导入
                    </button>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
    {{else}}
    <div style="padding: 3rem; text-align: center; color: var(--text-secondary);">
        <i data-lucide="search-x" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>
        <div>未找到证书</div>
        <div style="margin-top: 0.5rem; font-size: 0.875rem;">
            请检查证书目录配置：<code>{{.cert_dir}}</code>
        </div>
    </div>
    {{end}}
</div>
<script>lucide.createIcons();</script>
{{end}}
